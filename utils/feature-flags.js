import fs from "node:fs";import path from "node:path";import{fileURLToPath}from"node:url";const __dirname=path.dirname(fileURLToPath(import.meta.url));const ROOT=path.resolve(__dirname,"..");const FLAGS_PATH=path.resolve(ROOT,"data","feature-flags.json");let cache=null;let mtime=0;function readJSONSafe(p){try{const stat=fs.statSync(p);const text=fs.readFileSync(p,"utf8");const data=JSON.parse(text);return{data,mtimeMs:stat.mtimeMs}}catch{return{data:{discordWiring:false},mtimeMs:0}}}export function getFlags(){const{data,mtimeMs}=readJSONSafe(FLAGS_PATH);if(!cache||mtimeMs!==mtime){cache=data||{discordWiring:false};mtime=mtimeMs}return cache}export function isEnabled(flagName){const flags=getFlags();return Boolean(flags?.[flagName])}